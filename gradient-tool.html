<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">

    <title>Geostrophic Wind Ruler Â· MB Sailing â€“ Yacht Delivery & Weather Routing</title>

    <!-- SEO / Metadata -->
    <meta name="description" content="Geostrophisches Windlineal â€“ interaktives Tool zur AbschÃ¤tzung von Druckgradienten, geostrophischem Wind und geschÃ¤tztem Bodenwind anhand von IsobarenabstÃ¤nden. Praktisch fÃ¼r Segler, YachtÃ¼berfÃ¼hrungen und Wetterrouting.">
    <meta name="keywords" content="geostrophischer Wind, Druckgradient, Isobaren, Wetterrouting, Yacht Delivery, Segeln, Navigation, MB Sailing, geostrophic wind calculator, pressure gradient tool, wind aus isobaren, geostrophic wind ruler">
    <meta name="author" content="Matthias Baier â€“ MB Sailing">
    <meta name="license" content="CC BY-NC 4.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <!-- OG / Social Sharing -->
    <meta property="og:title" content="Geostrophisches Windlineal â€“ MB Sailing">
    <meta property="og:description" content="Interaktives Tool: aus IsobarenabstÃ¤nden Druckgradient, geostrophischen Wind und geschÃ¤tzten Bodenwind bestimmen. FÃ¼r Segler & Navigation.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://mb-sailing.com/ydrs-Dateien/image009.jpg">
    <meta property="og:url" content="https://mb-sailing.com/geostrophic-wind-ruler.html">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Geostrophisches Windlineal â€“ MB Sailing">
    <meta name="twitter:description" content="Interaktives Tool zur praktischen meteorologischen AbschÃ¤tzung fÃ¼r Segler.">
    <meta name="twitter:image" content="https://mb-sailing.com/ydrs-Dateien/image009.jpg">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="32x32" href="impressum-Dateien/image008.png">

<style>
/* ====== GLOBAL DESIGN ====== */
body {
    margin:0; padding:0;
    font-family:'IBM Plex Sans',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    background:#f5f5f5; color:#222; line-height:1.6;
}
.page {
    max-width:900px; margin:0 auto; padding:16px 20px 24px;
    background:#fff;
}
h1 { font-size:1.6rem; margin:0.3rem 0; }
p { font-size:0.95rem; margin:0.5rem 0; }

/* ===== NAV ===== */
.nav { display:flex; gap:16px; flex-wrap:wrap; padding:10px 0; margin:12px 0 20px; border-top:1px solid #ddd; border-bottom:1px solid #ddd; }
.nav a{color:#666;text-decoration:none;font-size:0.9rem;}
.nav a:hover{color:#0f766e;border-bottom:1px solid #0f766e;}
.nav a.active{font-weight:600;color:#0f766e;border-bottom:1px solid #0f766e;}

/* ===== TOOL AREA ===== */
.tool-shell{padding:0 0 40px;}
.tool-inner{max-width:2000px;margin:auto;padding:0 20px;}
.tool-wrapper{margin-top:1.2rem;display:flex;flex-direction:column;gap:1rem;}
#controls{
    background:#f9fafb;border-radius:0.75rem;border:1px solid #e5e7eb;
    padding:0.75rem;font-size:0.9rem;flex-shrink:0;
}
#canvasContainer{
    background:#f9fafb;border-radius:0.75rem;
    border:1px solid #e5e7eb;padding:0.5rem;
    width:100%;
}
#mapCanvas{
    display:block;width:100%!important;height:auto;
    border-radius:0.5rem;border:1px solid #d1d5db;
}

/* DESKTOP */
@media(min-width:900px){
    .tool-wrapper{flex-direction:row;align-items:flex-start;}
    #controls{width:320px;}
    #canvasContainer{flex:1;margin-left:0.75rem;}
}

/* MOBILE */
@media(max-width:600px){
    .page{padding:12px 14px;}
    footer{padding:10px 14px 20px;}
    h1{font-size:1.4rem;}
}
</style>
</head>

<body>

<div class="page">
<header>
<div class="logo-row" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
    <a href="index.html"><img src="ydrs-Dateien/image011.png" alt="MB Sailing" style="height:40px;"></a>
    <a href="mailto:alloceans@mb-sailing.com"><img src="ydrs-Dateien/image003.jpg" alt="Contact" style="height:40px;"></a>
</div>

<nav class="nav">
    <a href="index.html">Start</a>
    <a href="ydrs.html">Yacht Delivery</a>
    <a href="regatta.html">Regatta Campaigns</a>
    <a href="past-projects.html">Past Projects</a>
    <a href="links.html">Links</a>
    <a href="datenschutz.html">Datenschutz</a>
    <a href="impressum.html">Impressum</a>
</nav>

<img src="ydrs-Dateien/image009.jpg" alt="Offshore sailing â€“ MB Sailing" class="hero" style="width:100%;border-radius:4px;">
<div style="text-align:right;font-size:0.8rem;color:#666;">Photo: Ch. Mantel</div>

<h1>Geostrophisches Windlineal (Beta) not optimized for mobile devices</h1>
<p class="muted">Aus IsobarenabstÃ¤nden Druckgradient, geostrophischen Wind & Bodenwind abschÃ¤tzen â€“ direkt auf der Karte.</p>
</header>
</div>

<!-- ===== TOOL ===== -->
<div class="tool-shell"><div class="tool-inner">
<div class="tool-wrapper" id="gradient-tool">

<div id="controls">
<h3>Werkzeug</h3>
<p style="font-size:0.8rem;color:#555;">
1) Karte laden Â· 2) Kalibrieren Â· 3) Isobarenpunkte messen
</p>
<label>Karte laden:<input type="file" id="imageLoader" accept="image/*" style="width:100%;"></label>
<label>Î”Ï† (Â°):<input type="number" id="deltaPhiDeg" value="10" step="0.1"></label>
<label>Î”p (hPa):<input type="number" id="deltaP" value="5" step="0.1"></label>
<label>Breite Ï† (Â°):<input type="number" id="phiDeg" value="45" step="0.1"></label>
<label>Ï (kg/mÂ³):<input type="number" id="rho" value="1.25" step="0.01"></label>
<div style="margin-top:0.6rem;font-size:0.85rem;">
<b>Untergrund:</b><br>
<label><input type="radio" name="surface" id="surfaceSea" value="sea" checked> Ãœber See (~70 %)</label>
<label><input type="radio" name="surface" id="surfaceLand" value="land"> Ãœber Land (~60 %)</label>
</div>
<button id="btnCalibrate">Kalibrieren</button>
<button id="btnMeasure">Gradient messen</button>
<div id="status"></div>
<h4>Ergebnisse</h4><div id="results"></div>
<h4>Log</h4><div id="log" style="font-family:'IBM Plex Mono',monospace;white-space:pre-wrap;font-size:0.78rem;max-height:150px;overflow-y:auto;background:#f3f4f6;border-radius:6px;padding:6px;"></div>
</div>

<div id="canvasContainer"><canvas id="mapCanvas"></canvas></div>

</div></div></div>

<!-- ===== FOOTER ===== -->
<footer style="max-width:900px;margin:0 auto;padding:24px 20px;background:white;border-top:1px solid #ddd;font-size:0.9rem;color:#555;">
<div style="display:flex;justify-content:space-between;flex-wrap:wrap;">
    <strong>MB Sailing Â· Matthias Baier</strong>
    <span>Segeln Â· Wetterrouting Â· Navigation</span>
</div>

<div style="margin-top:8px;line-height:1.45;">
ğŸ“Œ <strong>Projekt & Code:</strong>
<a href="https://github.com/windsack/geostrophic-wind-ruler" target="_blank">github.com/windsack/geostrophic-wind-ruler</a><br>
Â© 2017â€“2025 Â· CC BY-NC 4.0 Â·
<a href="https://creativecommons.org/licenses/by-nc/4.0/deed.de" target="_blank">creativecommons.org/by-nc/4.0</a>
</div>

<div style="text-align:center;font-size:0.8rem;color:#777;margin-top:12px;">
ğŸ’¡ Weitere Tools in Arbeit â€” <strong>MB Projects</strong><br>
ğŸ‘‰ <a href="https://mb-sailing.com">mb-sailing.com</a>
</div>

<div style="font-size:0.75rem;color:#777;margin-top:14px;">
Suchbegriffe: Geostrophischer Wind Â· Druckgradient Â· Wind aus Isobaren Â· Yacht Wetterrouting Tool
</div>
</footer>

<!-- ===== EMAIL FILL ===== -->
<script>
document.querySelectorAll("a.email-link-header").forEach(a=>{
    a.href="mailto:alloceans@mb-sailing.com";
});
</script>

<!-- ===== MAIN SCRIPT (RETINA READY) ===== -->
<script>
// Canvas Setup
const imageLoader = document.getElementById('imageLoader');
const canvas = document.getElementById('mapCanvas');
const ctx = canvas.getContext('2d');

let img=new Image(),mode=null,clickPoints=[],kmPerPixel=null;

function log(msg){ const d=document.getElementById('log');d.textContent+=msg+"\n";d.scrollTop=d.scrollHeight;}

// RETINA LOAD
imageLoader.addEventListener('change', e=>{
    const file=e.target.files[0]; if(!file)return;
    const reader=new FileReader();
    reader.onload=ev=>{
        img=new Image();
        img.onload=()=>{
            const container=document.getElementById('canvasContainer');
            const logicalWidth=container.clientWidth;
            const scale=Math.min(1, logicalWidth/img.width);
            const dpr=window.devicePixelRatio||1;

            canvas.width  = Math.round(img.width*scale*dpr);
            canvas.height = Math.round(img.height*scale*dpr);
            canvas.style.width  = Math.round(img.width*scale)+"px";
            canvas.style.height = Math.round(img.height*scale)+"px";

            ctx.setTransform(dpr,0,0,dpr,0,0);
            redraw();
            log(`Bild: ${img.width}x${img.height} | DPR=${dpr} | Canvas=${canvas.width}x${canvas.height}`);
        };
        img.src=ev.target.result;
    };
    reader.readAsDataURL(file);
});

// ===== FUNCTIONS (gekÃ¼rzt, unverÃ¤ndert in Logik) =====
function setMode(m){
    mode=m;clickPoints=[];document.getElementById('status').textContent=(m==="calibrate")?"Kalibrieren":"Gradient messen";
}
document.getElementById('btnCalibrate').onclick=()=>setMode("calibrate");
document.getElementById('btnMeasure').onclick=()=>{
    if(kmPerPixel==null)return alert("Bitte erst kalibrieren."); setMode("measure");
};

canvas.onclick=e=>{
    if(!mode||!img.complete)return;
    const r=canvas.getBoundingClientRect(); const x=e.clientX-r.left, y=e.clientY-r.top;
    clickPoints.push({x,y}); if(clickPoints.length>2)clickPoints.shift();
    if(clickPoints.length===2){
        if(mode==="calibrate") calibrate();
        else measure();
    }
    redraw();
};

function redraw(){
    if(!img.complete||!canvas.width)return;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
}

function pixelDist(a,b){return Math.hypot(a.x-b.x,a.y-b.y);}
function calibrate(){
    const [p1,p2]=clickPoints; const dist=pixelDist(p1,p2);
    const dphi=parseFloat(deltaPhiDeg.value);const km=111.2*dphi;
    kmPerPixel=km/dist; log("Kalibriert: "+kmPerPixel.toFixed(3)+" km/px");
}
function measure(){
    const [p1,p2]=clickPoints;const distKM=pixelDist(p1,p2)*kmPerPixel;
    const dp=parseFloat(deltaP.value)*100,phi=parseFloat(phiDeg.value)*Math.PI/180;
    const rho=parseFloat(rho.value)||1.25;
    const f=2*7.2921e-5*Math.sin(phi),vg=(dp/(distKM*1000))/(rho*f);
    document.getElementById('results').innerHTML=`v<sub>g</sub> â‰ˆ ${vg.toFixed(1)} m/s`;
    log("v_g â‰ˆ "+vg.toFixed(2)+" m/s");
}
</script>

</body>
</html>
